<!DOCTYPE html>

<html lang="zh-CN" data-theme="light">

<head>
    <meta charset="UTF-8">
    <!-- ç§»åŠ¨ç«¯è§†å£è®¾ç½®ï¼Œè®©é¡µé¢æŒ‰è®¾å¤‡å®½åº¦æ¸²æŸ“ï¼Œåˆå§‹ç¼©æ”¾ 1 -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- æµè§ˆå™¨æ ‡ç­¾é¡µæ ‡é¢˜/æ”¶è—å¤¹åç§°/æœç´¢ç»“æœæ ‡é¢˜ -->
    <title>Nadir' Homepage</title>
    
    <!-- è¯·æ±‚æœåŠ¡ç«¯æœ¬åœ°ä¸‹è½½å¥½çš„ Pico.css å’Œ Vue cdn -->
    <!-- æ–‡ä»¶çš„ä¼ è¾“äº¤ç»™nginxï¼Œé…ç½®é‡Œæœ‰é…ç½®çš„é€šé…è·¯ç”± â€œ/â€ -->
    <link rel="stylesheet" href="./assets/pico.min.css">
    <script src="./assets/vue.global.js"></script>
    
    <style>
        /* å¦å¤–æ³¨æ„ï¼šclass="..."å³ HTML å±æ€§ã€‚ç›¸å½“äºç»™å…ƒç´ èµ·ä¸ªç»°å·ï¼ˆç”¨æ¥é€šè¿‡ CSS åŒ–å¦†ï¼‰ã€‚ */
        /* --- æ ¸å¿ƒå¸ƒå±€æ ·å¼ --- */
        body {
            background-color: #f5f7fa; /* æŸ”å’Œçš„ç°ç™½è‰²èƒŒæ™¯ */
            min-height: 100vh;
        }

        /* é™åˆ¶æœ€å¤§å®½åº¦ï¼Œå±…ä¸­æ˜¾ç¤º */
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding-top: 20px;
        }

        /* --- é¡¶éƒ¨å¯¼èˆªæ  (Tabs) --- */
        .nav-tabs {
            display: flex;
            justify-content: center;
            background: white;
            padding: 10px;
            border-radius: 16px; /* åœ†è§’ */
            box-shadow: 0 2px 10px rgba(0,0,0,0.05); /* æŸ”å’Œé˜´å½± */
            margin-bottom: 20px;
        }

        .nav-item {
            padding: 10px 25px;
            cursor: pointer;
            font-weight: bold;
            color: #666;
            border-radius: 10px;
            transition: all 0.2s;
        }

        /* é€‰ä¸­çŠ¶æ€ */
        .nav-item.active {
            background-color: #e3f2fd; /* æµ…è“è‰²é«˜äº® */
            color: #1976d2;
        }

        /* --- ç™½è‰²å¡ç‰‡é£æ ¼ --- */
        .white-card {
            background: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08); /* èˆ’æœçš„æ‚¬æµ®æ„Ÿ */
            border: 1px solid #f0f0f0;
            animation: fadeIn 0.3s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* ä»ªè¡¨ç›˜æ•°æ®çš„ Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-top: 20px;
        }
        .stat-box {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
        .stat-value { font-size: 1.5rem; font-weight: bold; color: #2c3e50; }
        .stat-label { font-size: 0.8rem; color: #7f8c8d; }

        /* é“¾æ¥å¡ç‰‡ */
        .tool-link {
            display: block;
            background: #fff;
            border: 1px solid #eee;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 8px;
            text-decoration: none;
            color: #333;
            transition: transform 0.2s;
            font-weight: bold;
        }
        .tool-link:hover {
            transform: scale(1.02);
            border-color: #1976d2;
        }
    </style>

</head>

<body>
    
   <!-- ID åèµ·ä¸º app, å°†æ­¤å¤„ä½œä¸ºæŒ‚è½½ç‚¹ã€‚Vue.js è¿è¡Œåä¼šè§£æè¿™ä¸ª div å†…éƒ¨çš„æ‰€æœ‰å†…å®¹ã€‚ -->
    <div id="app" class="container">
        
        <!-- å¯¼èˆªæ ï¼šç»˜åˆ¶é¡¶éƒ¨çš„ Tab åˆ‡æ¢æŒ‰é’® -->
        <nav class="nav-tabs">
            <div 
                class="nav-item" 
                :class="{ active: currentTab === 'home' }" 
                <!-- clickæ˜¯vueè¯­æ³•ï¼Œæ„æ€æ˜¯å½“ç”¨æˆ·ç”¨é¼ æ ‡ç‚¹å‡»è¿™é‡Œæ—¶ï¼Œæ‰§è¡Œåé¢çš„å‘½ä»¤ -->
                @click="switchTab('home')">
                ğŸ  ä¸»é¡µ
            </div>
            <div 
                class="nav-item" 
                :class="{ active: currentTab === 'status' }" 
                @click="switchTab('status')">
                âš¡ ç›‘æ§
            </div>
            <div 
                class="nav-item" 
                :class="{ active: currentTab === 'tools' }" 
                @click="switchTab('tools')">
                ğŸ› ï¸ å·¥å…·
            </div>
        </nav>

        <div v-if="currentTab === 'home'" class="white-card">
            <hgroup style="text-align: center; margin-bottom: 30px;">
                <h1>{{ profile ? profile.name : 'Loading...' }}</h1>
                <p>{{ profile ? profile.role : 'Connecting to Server...' }}</p>
            </hgroup>
            
            <div v-if="profile">
                <p><strong>æŠ€èƒ½æ ˆ:</strong></p>
                <div>
                    <span v-for="skill in profile.skills" :key="skill" 
                          role="button" class="outline" 
                          style="margin-right: 8px; font-size: 0.8rem; padding: 4px 10px;">
                        {{ skill }}
                    </span>
                </div>
            </div>
            <div v-else style="text-align: center; color: #999;">
                <p aria-busy="true">æ­£åœ¨è¿æ¥ä¸ªäººæ•°æ®...</p>
            </div>
        </div>
        
        <div v-if="currentTab === 'status'" class="white-card">
            <h3 style="border-bottom: 1px solid #eee; padding-bottom: 10px;">Server Status</h3>
            
            <div v-if="systemStatus" class="stats-grid">
                <div class="stat-box">
                    <div class="stat-label">CPU Load</div>
                    <div class="stat-value" :style="{ color: getLoadColor(systemStatus.cpu_percent) }">
                        {{ systemStatus.cpu_percent }}%
                    </div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">RAM Usage</div>
                    <div class="stat-value">
                        {{ systemStatus.ram_percent }}%
                    </div>
                    <small>{{ systemStatus.ram_used }} / {{ systemStatus.ram_total }}</small>
                </div>
                <div class="stat-box">
                    <div class="stat-label">Temperature</div>
                    <div class="stat-value">{{ systemStatus.temperature }}</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">Uptime</div>
                    <div class="stat-value" style="font-size: 1.2rem;">{{ systemStatus.uptime }}</div>
                </div>
            </div>

            <div v-else style="text-align: center; padding: 40px;">
                <p aria-busy="true">æ­£åœ¨è¯»å–ç¡¬ä»¶ä¼ æ„Ÿå™¨...</p>
            </div>

            <button @click="fetchStatus" class="secondary outline" style="margin-top: 20px; width: 100%;">
                åˆ·æ–°æ•°æ®
            </button>
        </div>

        <div v-if="currentTab === 'tools'" class="white-card">
            <h3>My Tools</h3>
            <div class="grid">
                <a href="/data/apps/player/" class="tool-link">ğŸµ éŸ³ä¹æ’­æ”¾å™¨</a>
                <a href="/data/apps/game/" class="tool-link">ğŸ® ç½‘é¡µæ¸¸æˆ</a>
                <a href="/files/" class="tool-link">ğŸ“‚ æ–‡ä»¶ç®¡ç†</a>
                <a href="/jupyter" class="tool-link">ğŸ““ Jupyter Lab</a>
            </div>
        </div>

    </div>


    <!-- JS è„šæœ¬éƒ¨åˆ† -->
    <script>
        const { createApp } = Vue
        createApp({  // åˆ›å»ºä¸€ä¸ª Vue åº”ç”¨å®ä¾‹
            
            data() {  // çŠ¶æ€ä»“åº“ã€‚å®šä¹‰äº† loadingã€profile ç­‰å˜é‡
                return {  // Vue ä¼šç›‘æ§è¿™äº›å˜é‡ï¼Œä¸€å˜é¡µé¢å°±è‡ªåŠ¨åˆ·
                    currentTab: 'home', // é»˜è®¤æ˜¾ç¤ºä¸»é¡µ
                    profile: null,
                    loading: false,
                    systemStatus: null,
                }
            },
            mounted() {  // ç”Ÿå‘½å‘¨æœŸé’©å­, ç›¸å½“äº Python ç±»çš„ __init__ æˆ–â€œå¼€æœºå¯åŠ¨é¡¹â€
                // é¡µé¢åŠ è½½å®Œé‚£ä¸€ç¬é—´ï¼Œè‡ªåŠ¨æ‰§è¡Œ fetchProfile() å»æ‹‰åç«¯æ•°æ®ã€‚
                this.fetchProfile()
            },
            methods: {  // æ ¸å¿ƒé€»è¾‘å‡½æ•°

                // åˆ‡æ¢ Tab çš„é€»è¾‘
                switchTab(tabName) {
                    this.currentTab = tabName
                    // å¦‚æœåˆ‡æ¢åˆ°äº† 'status' ä¸”æ²¡æœ‰æ•°æ®ï¼Œæ‰å»é€šè¿‡fetchStatus()è¯·æ±‚
                    if (tabName === 'status' && !this.systemStatus) {
                        this.fetchStatus()
                    }
                },

                // è·å–ä¸ªäººä¿¡æ¯
                async fetchProfile() {
                    try {
                        const res = await fetch('/api/profile')
                        if (res.ok) this.profile = await res.json()
                    } catch (e) {
                        console.error(e)
                    }
                },

                // è·å–ç³»ç»ŸçŠ¶æ€ (ç‚¹å‡» Tab 2 æ—¶è§¦å‘)
                async fetchStatus() {
                    this.systemStatus = null // å…ˆæ¸…ç©ºï¼Œæ˜¾ç¤º loading
                    try {
                        const res = await fetch('/api/status')
                        if (res.ok) {
                            this.systemStatus = await res.json()
                        }
                    } catch (e) {
                        console.error("Status fetch failed", e)
                    }
                },

                // è¾…åŠ©å‡½æ•°ï¼šCPU è´Ÿè½½è¿‡é«˜å˜çº¢
                getLoadColor(percent) {
                    if (percent > 80) return '#e74c3c' // çº¢
                    if (percent > 50) return '#f39c12' // æ©™
                    return '#2ecc71' // ç»¿
                }

            }
        }).mount('#app')
    </script>

</body>

</html>
